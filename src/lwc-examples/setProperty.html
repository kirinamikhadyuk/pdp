<template lwc:render-mode='light'>
    <div if:false={showCompanyPart}>
        <div if:false={loading} class="step step-about-you">
            <div class="step-about-you__container">
                <template if:false={showCompanyPart}>
                    <h1 class="step-about-you__title">{content.ETE_STEP_about_you.title_about_you}</h1>
                    <h3 class="step-about-you__title-info">{content.ETE_STEP_about_you.description_about_you}</h3>
                    <div class="step-about-you__input-items">
                        <div class="step-about-you__input-block step-about-you__input-block_salutations">
                            <ui-picklist
                                    label={content.ETE_STEP_about_you.salutation_title_cd}
                                    selected-value={user.salutation}
                                    options={settings.ETE_STEP_about_you.salutations}
                                    data-field="salutation"
                                    required={settings.ETE_STEP_about_you.salutation_required}
                                    error-message={content.ETE_STEP_about_you.salutation_errorMessage_cd}
                                    onchange={handleDataChange}>
                            </ui-picklist>
                        </div>
                        <div class="step-about-you__input-block step-about-you__input-block_first-name">
                            <ui-input
                                    label={content.ETE_STEP_about_you.firstName_label_cd}
                                    value={user.firstName}
                                    data-field="firstName"
                                    input-name="firstname"
                                    reg-exp={settings.ETE_STEP_about_you.firstName_regex}
                                    max-length={settings.ETE_STEP_about_you.firstName_maxlength}
                                    oninput={handleDataChange}
                                    required={settings.ETE_STEP_about_you.firstName_required}
                                    empty-field-error-message={content.ETE_STEP_about_you.firstName_emptyField_error_cd}
                                    invalid-input-error-message={content.ETE_STEP_about_you.firstName_invalidInput_error_cd}>
                            </ui-input>
                        </div>
                        <div class="step-about-you__input-block">
                            <ui-input
                                    class="step-about-you__input-block-item"
                                    label={content.ETE_STEP_about_you.lastName_label_cd}
                                    value={user.lastName}
                                    data-field="lastName"
                                    input-name="lastname"
                                    reg-exp={settings.ETE_STEP_about_you.lastName_regex}
                                    max-length={settings.ETE_STEP_about_you.lastName_maxlength}
                                    oninput={handleDataChange}
                                    required={settings.ETE_STEP_about_you.lastName_required}
                                    empty-field-error-message={content.ETE_STEP_about_you.lastName_emptyField_error_cd}
                                    invalid-input-error-message={content.ETE_STEP_about_you.lastName_invalidInput_error_cd}>
                            </ui-input>
                        </div>
                        <div class="step-about-you__input-block">
                            <ui-input
                                    type="email"
                                    class="step-about-you__input-block-item step-contact__input-block-item_email"
                                    label={content.ETE_STEP_about_you.email_label_cd}
                                    value={user.email}
                                    data-field="email"
                                    input-name="email"
                                    reg-exp={settings.ETE_STEP_about_you.email_regex}
                                    max-length={settings.ETE_STEP_about_you.email_maxlength}
                                    oninput={handleDataChange}
                                    required={settings.ETE_STEP_about_you.email_required}
                                    empty-field-error-message={content.ETE_STEP_about_you.email_emptyField_error_cd}
                                    invalid-input-error-message={content.ETE_STEP_about_you.email_invalidInput_error_cd}>
                            </ui-input>
                        </div>
                        <div class="step-about-you__input-block">
                            <ui-input
                                    type="phone"
                                    class="step-about-you__input-block-item"
                                    label={content.ETE_STEP_about_you.phone_label_cd}
                                    value={user.phone}
                                    data-field="phone"
                                    input-name="phone"
                                    check-on-input="true"
                                    reg-exp={settings.ETE_STEP_about_you.phone_regex}
                                    max-length={settings.ETE_STEP_about_you.phone_maxlength}
                                    oninput={handleDataChange}
                                    required={settings.ETE_STEP_about_you.phone_required}
                                    empty-field-error-message={content.ETE_STEP_about_you.phone_emptyField_error_cd}
                                    invalid-input-error-message={content.ETE_STEP_about_you.phone_invalidInput_error_cd}>
                            </ui-input>
                        </div>
                        <div class="step-about-you__input-block">
                            <ui-picklist
                                    class="step-about-you__input-block-item"
                                    label={content.ETE_STEP_about_you.businessType_label_cd}
                                    options={settings.business_settings.business_types}
                                    data-field="selectedCompanyName"
                                    selected-value={user.selectedCompanyName}
                                    onchange={handleChangeBusinessType}
                                    required={settings.ETE_STEP_about_you.selectedCompanyName_required}
                                    error-message={content.ETE_STEP_about_you.businessType_errorMessage_cd}>
                            </ui-picklist>
                        </div>
                        <div class="step-about-you__input-block">
                            <ui-input
                                    class="step-about-you__input-block-item"
                                    label={companyNameLabel}
                                    value={companyName}
                                    data-field="companyName"
                                    input-name="companyName"
                                    reg-exp={companyNameRegex}
                                    max-length={settings.ETE_STEP_about_you.companyName_maxlength}
                                    empty-field-error-message={companyNameErrorMessage}
                                    invalid-input-error-message={notSelectedCompanyNameErrorMessage}
                                    oninput={handleCompanyNameInput}
                                    required={settings.ETE_STEP_about_you.companyName_required}
                                    autocomplete-disabled="true"
                                    disabled={companyInputDisabled}
                                    onclick={handleCompanyName}
                                    onblur={handleCompanyNameBlur}
                                    is-loading={USER.isAddressSearchActive}
                            ></ui-input>
                        </div>
                        <div class="step-about-you__input-block">
                            <c-company-lookup-component
                                    if:true={lookupVisible}
                                    is-manual-entry-possible={isManualEntryPossible}
                                    data-field="companyNameLookup"
                                    oncompanyselected={handleCompanySelected}
                                    oncompanyselectedinfo={handleSelectedCompanyInfo}
                                    oncantfindmycompany={handleCantFindMyCompany}
                                    class="step-about-you__company-lookup-component"
                                    companies-data={companiesData}
                                    selected-company={selectedCompany}
                                    previous-name-value={previousCompanyNameValue}
                                    search-by={companySearchByType}
                                    cant-find-label={content.ETE_STEP_about_you.cantFindMyCompany}
                                    required={settings.ETE_STEP_about_you.addressLookup_required}
                                    company-name={companyName}
                                    company-type={companyType}>
                            </c-company-lookup-component>
                        </div>
                    </div>
                    <div if:true={proofOfBusinessAddressVisible} class="step-about-you__delimiter"></div>
                    <div if:true={proofOfBusinessAddressVisible}>
                        <h3 class="step-about-you__subtitle">
                            {content.ETE_STEP_about_you.proof_of_business_address_title}</h3>
                        <div class="step-about-you__input-items">
                            <div class="step-about-you__input-block step-about-you__input-block_post-code">
                                <c-address-lookup-component
                                        if:true={businessAddressFoundViaLookup}
                                        label={content.ETE_STEP_about_you.proof_of_business_address_postcode_input_label}
                                        max-length={settings.ETE_STEP_about_you.companyPostcode_maxlength}
                                        required="true"
                                        invalid-input-error-message={content.ETE_STEP_about_you.proof_of_business_address_postcode_lookup_error}
                                        empty-field-error-message={content.ETE_STEP_about_you.proof_of_business_address_postcode_lookup_ef_error}
                                        postcode={companyPostcode}
                                        value-selected={lookupValueSelected}
                                        oninput={handleAddressInput}
                                        onselect={handleAddressSelected}
                                        onchange={handleAddressChange}
                                        onclick={handleAddressClick}
                                        data-field="postcodeLookup"
                                ></c-address-lookup-component>
                            </div>
                            <div class="step-about-you__input-block step-about-you__input-block_button"
                                 data-name="switchButtonContainer">
                                <ui-button
                                        class="step-about-you__switch-button"
                                        onclick={handleSwitchSearchType}
                                        size="medium">
                                    {buttonLabel}
                                </ui-button>
                            </div>
                        </div>
                        <div class="step-about-you__input-items">
                            <div class="step-about-you__input-block">
                                <ui-label
                                        if:true={isAddressLabelVisible}
                                        text={_selectedData}
                                ></ui-label>
                            </div>
                        </div>
                        <template if:false={businessAddressFoundViaLookup}>
                            <div class="step-about-you__business-address-input-item">
                                <div class="step-about-you__input-block">
                                    <ui-input
                                            label={content.ETE_STEP_about_you.proof_of_business_address_address_line}
                                            value={locationLine}
                                            data-field="locationLine"
                                            input-name="locationLine"
                                            reg-exp={settings.ETE_STEP_about_you.street_regex}
                                            max-length={settings.ETE_STEP_about_you.street_maxlength}
                                            required={settings.ETE_STEP_about_you.street_required}
                                            oninput={handleDataChange}
                                            empty-field-error-message={content.ETE_STEP_about_you.proof_of_business_address_address_line_ef_error}
                                            invalid-input-error-message={content.ETE_STEP_about_you.proof_of_business_address_address_line_ii_error}
                                    ></ui-input>
                                </div>
                                <div class="step-about-you__input-block">
                                    <ui-input
                                            label={content.ETE_STEP_about_you.proof_of_business_address_city_label}
                                            value={user.city}
                                            data-field="city"
                                            input-name="city"
                                            reg-exp={settings.ETE_STEP_about_you.city_regex}
                                            max-length={settings.ETE_STEP_about_you.city_maxlength}
                                            required={settings.ETE_STEP_about_you.city_required}
                                            oninput={handleDataChange}
                                            empty-field-error-message={content.ETE_STEP_about_you.proof_of_business_address_city_ef_error}
                                            invalid-input-error-message={content.ETE_STEP_about_you.proof_of_business_address_city_ii_error}
                                    ></ui-input>
                                </div>
                                <div class="step-about-you__input-block">
                                    <ui-input
                                            label={content.ETE_STEP_about_you.proof_of_business_address_county_label}
                                            value={user.state}
                                            data-field="state"
                                            input-name="state"
                                            reg-exp={settings.ETE_STEP_about_you.state_regex}
                                            max-length={settings.ETE_STEP_about_you.state_maxlength}
                                            required={settings.ETE_STEP_about_you.state_required}
                                            oninput={handleDataChange}
                                            empty-field-error-message={content.ETE_STEP_about_you.proof_of_business_address_county_ef_error}
                                            invalid-input-error-message={content.ETE_STEP_about_you.proof_of_business_address_county_ii_error}
                                    ></ui-input>
                                </div>
                                <div class="step-about-you__input-block">
                                    <ui-input
                                            label={content.ETE_STEP_about_you.proof_of_business_address_postcode_label}
                                            value={user.companyPostcode}
                                            data-field="companyPostcode"
                                            input-name="companyPostcode"
                                            reg-exp={settings.ETE_STEP_about_you.companyPostcode_regex}
                                            max-length={settings.ETE_STEP_about_you.companyPostcode_maxlength}
                                            oninput={handleDataChange}
                                            onblur={handlePostcodeBlur}
                                            required={settings.ETE_STEP_about_you.companyPostcode_required}
                                            empty-field-error-message={content.ETE_STEP_about_you.proof_of_business_address_postcode_ef_error}
                                            invalid-input-error-message={content.ETE_STEP_about_you.proof_of_business_address_postcode_ii_error}
                                    ></ui-input>
                                </div>
                            </div>
                        </template>
                    </div>
                </template>
            </div>
        </div>
        <p if:false={showCompanyPart} class="step-about-you__privacy-bottom-text"></p>
        <template if:false={loading}>
            <c-step-navigation
                    if:false={showCompanyPart}
                    onnext={handleNext}
                    error-text={errorText}
                    error={stepError}
                    warning={USER.isAddressSearchActive}
            ></c-step-navigation>
        </template>
    </div>
    <step-step-company-details
            if:true={showCompanyPart}
    ></step-step-company-details>
</template>
